<!DOCTYPE html>
<html>
  <div class="container">
    <div class="row">
      <div class="col">
         <h1>注文履歴詳細</h1>

         <table>
           <tr>
             <td>購入者</td>
             <td>
               <%= link_to admin_orders_customer_path do %>
               <%= @order.customer.last_name + @order.customer.first_name %>
               <% end %>
             </td>
           </tr>
           <tr>
             <td>注文日</td>
             <td><%= @order.created_at.strftime('%Y/%m/%d') %></td>
           </tr>
           <tr>
             <td>配送先</td>
             <td><%= @order.post_code + @order.address %></td>
             <td><%= @order.customer_name %></td>
           </tr>
           <tr>
             <td>支払い方法</td>
             <td><%= @order.payment_method_i18n %></td>
           </tr>
           <tr>
             <td>注文ステータス</td>
             <%= form_with model: @order, url: admin_order_path(@order), method: :post do |f| %>
             <td><%= f.select :order_status, Order.order_statuses_i18n.invert %></td>
             <td><%= f.submit "更新", class:"btn btn-success" %></td>
             <% end %>
           </tr>
         </table>
      </div>
     </div>
     <div class="row">
       <div class="col-8">
         <table>
           <thead>
             <tr>
               <th class="table-active">商品名</th>
               <th class="table-active">単価（税込）</th>
               <th class="table-active">数量</th>
               <th class="table-active">小計</th>
               <th class="table-active">製作ステータス</th>
             </tr>
           </thead>
           <tbody>
             <% @order.order_details.each do |order_detail| %>
             <tr>
               <td><%= order_detail.product.product_name %></td>
               <td><%= order_detail.price %></td>
               <td><%= order_detail.amount %></td>
               <td><%= order_detail.order_subtotal_price %></td>
              <% end %>
               <%#= form_with model: @order_detail, url: admin_order_detail_path(@order_detail), method: :post do |f| %>
               <td>
                  <%#= f.select :making_status, OrderDetail.making_status_i18n.invert  %>
                  <%#= f.submit "更新", class:"btn btn-success" %>
               </td>
               <%# end %>
             </tr>

           </tbody>
         </table>
        </div>
        <div class ="col-4">
         <table class="ordertotals">
           <tr>
             <th>商品合計</th>
             <td><%= @order.shipping_cost.to_s %>円</td>
           </tr>
           <tr>
             <th>送料</th>
             <td><%= @order.shipping_fee.to_s %>円</td>
           </tr>
           <tr>
             <th>請求金額合計</th>
             <td><%= @order.shipping_cost + @order.shipping_fee %>円</td>
           </tr>
         </table>
        </div>
  </div>
</html>